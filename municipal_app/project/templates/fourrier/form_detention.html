{% extends "_base.html" %}
{% block content %}
<h1 class="page-title">مستودع الحجز </h1>
<div class="panel panel-default animated fadeInUp go">
	<div class="panel-heading clearfix">
		{% if update %}
		<h3 class="panel-title">تحيين المحجوز</h3>
		{% else %}
		<h3 class="panel-title">إضافة مستودع</h3>
		{% endif %}
		<ul class="panel-tool-options"> 
			<li><a data-rel="collapse" href="#"><i class="icon-down-open"></i></a></li>
			<li><a data-rel="reload" href="#"><i class="icon-arrows-ccw"></i></a></li>
		</ul>
	</div>
	{% if update %}
	<div class='panel-body'>
		<form action="/update_detention" method="POST">
			<div class="form-group">
				<div class="row">
					<div class="col-md-4">تاريخ الحجز *<div class="form-group-inner"><input type="text" class="form-control" placeholder="" name='Date_Detention' value='{{detention_data.Date_Detention}}' id ="maj" readonly></div></div>
					<div class="col-md-4">أسباب الحجز *<div class="form-group-inner"><input type="text" class="form-control" placeholder="" id ="maj" name='Cause_Detention' value='{{detention_data.Cause_Detention}}' readonly></div></div>
					<div class="col-md-4">الجهة التي صدر منها الاذن بالحجز *<div class="form-group-inner"><select type="text" class="form-control" placeholder="" id ="maj" name='Authority_Detention' value='{{detention_data.Authority_Detention}}' readonly>
						<option value="{{detention_data.Authority_Detention}}">{{detention_data.Authority_Detention}}</option>
						{% for a in authority_option %}
						{% if a[0] not in detention_data.Authority_Detention %}
						<option value='{{a[0]}}'>{{a[1]}}</option>
						{% endif %}
						{% endfor %}
					</select>
				</div>
			</div>
		</div>                    
		<div class="row">
			<div class="col-md-4">اسم واللقب صاحب المحجوز<div class="form-group-inner"><input type="text" class="form-control" placeholder="" name='Name_Owner' value='{{detention_data.Name_Owner}}' id ="maj" readonly></div></div>
			<div class="col-md-4">نوع المحجوز *<div class="form-group-inner"><input type="text" class="form-control" placeholder="" name='Type_Detention' value='{{detention_data.Type_Detention}}' id ="maj" readonly></div></div>
			<div class="col-md-4">مستودع الحجز *<div class="form-group-inner"><select type="text" class="form-control" placeholder="" id ="maj" name='fourrier_id' value='{{detention_data.fourrier_id}}' readonly>
				<option value="{{detention_data.fourrier_id}}">{{detention_data.Name_Fourrier}}</option>
				{% for a in name_fourrier_option %}
				{% if a[1] not in  detention_data.Name_Fourrier %}
				<option value='{{a[0]}}'>{{a[1]}}</option>
				{% endif %}
				{% endfor %}
			</select>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-4">الترقيم المنجمي *<div class="form-group-inner"><input type="text" class="form-control" placeholder="" name='Registration_Detention' value='{{detention_data.Registration_Detention}}' id ="maj" readonly></div></div>
	<div class="col-md-4">وصف المحجوز <div class="form-group-inner"><input type="textarea" class="form-control" placeholder="" id ="maj" name='Descr_Detention' value='{{detention_data.Descr_Detention}}' readonly></div></div>
</div>
</div>
<div class="form-group animated fadeInUp go" id='save_encours' style="display:none">
	<div class="col-sm-6">
		<button class="btn btn-primary btn-block" type="submit">حفظ</button>
	</div>
	<div class="col-sm-6">
		<a href='/fourrier' class="btn btn-red btn-block" type="submit">إلغاء</a>
		<input type="hidden" name="d_id" value="{{detention_data.id}}">
	</div>
</div>
</form>
<input class="btn btn-info btn-outline btn-block" name='button' id="btnEdit" type="submit" value= 'تحيين المحجوز' style="display:block">
</div>
{% else %}
<div class='panel-body'>
	<form class="form-horizontal" role="form" method="post" action="">
		{{ form.csrf_token }}
		<div class="form-group"> 
			<label class="col-sm-3 control-label">تاريخ الحجز *</label> 
			<div class="col-sm-5">
				{{ form.Date_Detention( class="form-control") }}
				{% if form.Date_Detention.errors %}
				{% for error in form.Date_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">أسباب الحجز *</label> 
			<div class="col-sm-5">
				{{ form.Cause_Detention( class="form-control") }}
				{% if form.Cause_Detention.errors %}
				{% for error in form.Cause_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">وصف المحجوز</label> 
			<div class="col-sm-5">
				{{ form.Descr_Detention( class="form-control", type="textarea") }}
				{% if form.Descr_Detention.errors %}
				{% for error in form.Descr_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">اسم واللقب صاحب المحجوز إن وجد</label> 
			<div class="col-sm-5">
				{{ form.Name_Owner( class="form-control") }}
				{% if form.Name_Owner.errors %}
				{% for error in form.Name_Owner.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">الجهة التي صدر منها الاذن بالحجز *</label> 
			<div class="col-sm-5">
				{{ form.Authority_Detention( class="form-control") }}
				{% if form.Authority_Detention.errors %}
				{% for error in form.Authority_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">نوع المحجوز *</label> 
			<div class="col-sm-5">
				{{ form.Type_Detention( class="form-control") }}
				{% if form.Type_Detention.errors %}
				{% for error in form.Type_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">الترقيم المنجمي</label> 
			<div class="col-sm-5">
				{{ form.Registration_Detention( class="form-control") }}
				{% if form.Registration_Detention.errors %}
				{% for error in form.Registration_Detention.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
		</div>
		<div class="form-group"> 
			<label class="col-sm-3 control-label">مستودع الحجز *</label> 
			<div class="col-sm-5">
				{{ form.Name_Fourrier2( class="form-control") }}
				{% if form.Name_Fourrier2.errors %}
				{% for error in form.Name_Fourrier2.errors %}
				{{ error }}
				{% endfor %}
				{% endif %}
			</div>
			<div class="col-sm-4">
				<a href='/add_fourrier'><p class="text-info"><strong>إضافة مستودع حجز جديد</strong></p></a>
			</div>
		</div>
		<div class="form-group">
			<div class="col-sm-6">
				<button class="btn btn-primary btn-block" type="submit">حفظ</button>
			</div>
			<div class="col-sm-6">
				<a href='/fourrier' class="btn btn-red btn-block" type="submit">إلغاء</a>
			</div>
		</div>
	</form>
</div>
{% endif %}
</div>
{% block js %}

<script>

$(document).ready(function()
{
	$('#btnEdit').click(function()
	{
		$("input[id='Longitude']").removeAttr("readonly")
		$("input[id='Laltitude']").removeAttr("readonly")
		$("input[id='maj']").removeAttr("readonly")
		$("div[id=row_map]").removeAttr('style')
		$("div[id=save_encours]").removeAttr('style')
		$('#btnEdit').css({
			'display': 'none',
		});  
	});

});


var mymap = L.map('mapid').setView([36.35025049076684, 9.622135162353514], 15);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
	maxZoom: 18,
	attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
	'<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
	'Imagery © <a href="http://mapbox.com">Mapbox</a>',
	id: 'mapbox.streets'
}).addTo(mymap);

L.marker([36.35025049076684, 9.622135162353514]).addTo(mymap)
.bindPopup("<b>yoooo بلدية</b><br />").openPopup();




var popup = L.popup();

function onMapClick(e) {
	document.getElementById('Laltitude').value = e.latlng.lat.toString();
	document.getElementById('Longitude').value = e.latlng.lng.toString();
	popup
	.setLatLng(e.latlng)
	.setContent("<i class='fa fa-map-marker'/>" + e.latlng.toString())
	.openOn(mymap);
}

mymap.on('click', onMapClick);

</script>
{% endblock %}
{% endblock %}